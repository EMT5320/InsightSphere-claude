<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InsightSphere - 加密货币数据可视化仪表盘</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMTYiIGN5PSIxNiIgcj0iMTYiIGZpbGw9IiMzNDk4ZGIiLz4KPHN2ZyB4PSI4IiB5PSI4IiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTggMkw5LjA5IDYuMjZMMTMuNjYgNC43NEwxMS4yNiA5LjA5TDE0IDhMMTAuNzQgMTMuNjZMMTIgMTZMNi43NCAxNC43NEw4IDE2TDQuNzQgMTAuNzRMMCA4TDUuMjYgNi43NEw0IDE2TDYuNzQgNC43NEw4IDJaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4KPC9zdmc+">
    
    <!-- Meta Tags -->
    <meta name="description" content="InsightSphere - 实时加密货币数据可视化仪表盘，提供全球市场概览、Top 10排行榜和交互式图表">
    <meta name="keywords" content="加密货币,比特币,以太坊,数据可视化,实时图表,市值,交易量">
    <meta name="author" content="InsightSphere">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>🌐 InsightSphere</h1>
            <p>实时加密货币数据可视化仪表盘</p>
        </header>

        <!-- Main Dashboard -->
        <main class="dashboard">
            <!-- Global Market Overview Card -->
            <section class="card">
                <div class="card-header">
                    <div class="card-icon" style="background: linear-gradient(45deg, #667eea, #764ba2);">
                        🌍
                    </div>
                    <h2 class="card-title">全球市场概览</h2>
                </div>
                <div id="global-stats" class="global-stats">
                    <div class="loading">
                        <div class="spinner"></div>
                    </div>
                </div>
            </section>

            <!-- Top 10 Cryptocurrencies Card -->
            <section class="card">
                <div class="card-header">
                    <div class="card-icon" style="background: linear-gradient(45deg, #f093fb, #f5576c);">
                        🏆
                    </div>
                    <h2 class="card-title">Top 10 加密货币</h2>
                </div>
                <div class="table-container">
                    <table class="crypto-table">
                        <thead>
                            <tr>
                                <th>排名</th>
                                <th>货币</th>
                                <th>价格 (USD)</th>
                                <th>24h涨跌</th>
                                <th>市值</th>
                                <th>24h交易量</th>
                            </tr>
                        </thead>
                        <tbody id="crypto-tbody">
                            <tr>
                                <td colspan="6">
                                    <div class="loading">
                                        <div class="spinner"></div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </main>

        <!-- Market Cap Distribution Chart -->
        <section class="card">
            <div class="card-header">
                <div class="card-icon" style="background: linear-gradient(45deg, #4facfe, #00f2fe);">
                    📊
                </div>
                <h2 class="card-title">市值分布图</h2>
            </div>
            <div class="chart-container">
                <canvas id="marketCapChart"></canvas>
            </div>
        </section>

        <!-- Last Updated Info -->
        <footer class="last-updated">
            <div id="last-updated">等待数据加载...</div>
            <div style="margin-top: 10px;">
                <button id="refresh-button" onclick="window.insightSphere && window.insightSphere.refresh()" 
                        style="background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 8px 16px; border-radius: 5px; cursor: pointer; transition: all 0.3s ease;">
                    🔄 手动刷新
                </button>
            </div>
            <div style="margin-top: 15px; font-size: 0.8rem;">
                <p>数据来源: <a href="https://www.coingecko.com/" target="_blank" style="color: white;">CoinGecko API</a></p>
                <p>自动刷新间隔: 60秒 | 缓存时间: 30秒</p>
            </div>
        </footer>
    </div>

    <!-- Error Fallback -->
    <noscript>
        <div style="position: fixed; top: 0; left: 0; right: 0; background: #dc3545; color: white; padding: 15px; text-align: center; z-index: 9999;">
            <strong>⚠️ 请启用JavaScript以使用InsightSphere</strong>
        </div>
    </noscript>

    <!-- JavaScript -->
    <script>
        // 检查Chart.js是否加载成功
        if (typeof Chart === 'undefined') {
            document.body.innerHTML += `
                <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); text-align: center; z-index: 9999;">
                    <h3 style="color: #dc3545; margin-bottom: 15px;">⚠️ 资源加载失败</h3>
                    <p>图表库加载失败，请检查网络连接并刷新页面。</p>
                    <button onclick="window.location.reload()" style="background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 15px;">刷新页面</button>
                </div>
            `;
        }
    </script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
